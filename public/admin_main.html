<!DOCTYPE html>
<html>
	<head>
		<meta charset="UTF-8">
		<title></title>
		<link rel="stylesheet" type="text/css" href="css/bootstrap.css"/>
		<script src="js/jquery.min.js"></script>
		<script src="js/popper.min.js"></script>
		<script src="js/bootstrap.min.js"></script>
		<style type="text/css">
			
			#left{
				height: 945px;
			}
			#index{
				margin-top:16px;
			}
			#update_su{
				position: relative;
				top: 20px;
				left: 300px;
			}
			.guding{
				width: 400px;
				height: 30px;
				position: fixed;
				bottom: 0px;
				left: 160px;
			}
		</style>
	</head>
	<body onload="getInfo()">
			<div class="container-fluid">
			<div class="row">
				<div class="col-xl-3 col-md-4 navbar bg-dark navbar-dark p-0 d-lg-block  d-xl-block" id="left">
			<!--左边第一行-->
					<div class="row">
						<div class="col-md-4">
							<a href="admin.html">
							<img src="img/logo_r35j.png" class="rounded-circle img-fluid"/>
							</a>
						</div>
						<div class="col-md-8">
							<h4 class="text-light mt-2">某旅游后台</h4>							
						</div>
					</div>
			<!--左边第二行 欢迎回来-->
					<div class="row mt-4">
						<div class="col-md-5">
							<img src="img/IMG_3779.png" class="rounded-circle bg-light img-fluid w-50 mt-2 ml-4"/>
						</div>
						<div class="col-md-7">
							<p class="text-light ">欢迎回来</p>
							<h6 class="text-light">超级管理员</h6>
						</div>
					</div>
					<hr />
			<!--左边第三行  后台管理-->
					<div class="row w-100 ml-1 mt-4 border border-left-0">
						<div class="col-lg-12">
							<p class="text-light text-center" id="index"><a href="admin.html" class=" text-light mt-2">后台首页</a></p>
						</div>
					</div>
					<hr />
			<!--左边第四行 数据管理-->
					<div class="row w-100 mt-4">
						<div class="col-lg-12">
							<h6 class="text-light mt-0 ml-0">数据管理</h6>
						</div> 
					</div>
			<!--左边第五行 景点管理  ,用户管理    下拉框,小三角,手风琴效果-->
		<div id="parent">
			<div class="card bg-dark">
				<div class="card-header">
					<a href="#coll-one" class="card-link text-light" data-toggle="collapse">景点管理
					</a>
					<span class="dropdown-toggle float-right"></span>
				</div>
				<div data-parent="#parent" id="coll-one" class="collapse">
					<div class="card-body">
						<!--景点二级菜单-->
						<ul class="list-unstyled">
							<li class="text-light mt-3">
								<a href="#" class="nav-link text-light">景点列表</a>
							</li>
							<li class="text-light  mt-3">
								<a href="#" class="nav-link text-light">添加景点</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
			<div class="card bg-dark">
				<div class="card-header">
					<a href="#coll-two" class="card-link text-light" data-toggle="collapse">用户管理
					</a>
					<span class="dropdown-toggle float-right"></span>
				</div>
				<div data-parent="#parent" id="coll-two" class="collapse">
					<div class="card-body">
						<ul class="list-unstyled">
							<li class="text-light mt-3">
								<a href="admin_list.html" class="nav-link text-light">用户列表</a>
							</li>
							<li class="text-light  mt-3">
								<a href="#" class="nav-link text-light">用户检索</a>
							</li>
						</ul>
					</div>
				</div>
			</div>
		</div>
			<!--左边空白区域-->
					
			<!--左边下边-->
					
							<div class="guding bg-secondary">12254544645</div>
						
				</div>
				<!--右边-->
				<div class="col-xl-8 col-md-8 bg-light">
				<!--右第一行-->
					<div class="row bg-secondary">
						<div class="col-md-1 navbar-light mt-2">
							<span class="navbar-toggler navbar-toggler-icon"></span>
						</div>
						<div class="col-md-7"></div>
						<div class="col-md-4">
							<img src="img/IMG_3779.png" class="w-25"/>
							<button class="dropdown btn" data-toggle="collapse" data-target="#admin">超级管理员
								<span class="dropdown-toggle"></span>
							</button>
							<ul class="list-unstyled collapse border" id="admin">
								<li>基本信息</li>
								<li>用户设置</li>
								<li>退出登录</li>
							</ul>
						</div>
					</div>
						<h3 class="border-bottom p-2">修改用户</h3>
						<div>
							<table class="table table-striped table-hover mt-4">
								<tr>
									<td>用户名:</td>
									<td><input type="text" id="uname" /></td>
									<td>用户名长度在6~9之间</td>
								</tr>
								<tr>
									<td>密码:</td>
									<td><input type="password" id="upwd" /></td>
									<td>密码长度在6~12之间</td>
								</tr>
								
								<tr>
									<td>邮箱:</td>
									<td><input type="text" id="emaiil" /></td>
									<td>请修改合法的邮箱地址</td>
								</tr>
								<tr>
									<td>手机号:</td>
									<td><input type="text" id="phone" /></td>
									<td>请修改合法的手机号</td>
								</tr>
								<tr>
									<td>真实姓名:</td>
									<td><input type="text" id="username" /></td>
									<td>长度不能超过6~12</td>
								</tr>
								<tr >
									<td>性别:</td>
									<td>
										<input type="radio" id="man" name="gender" value="1"/>
										<label for="man">男</label>
										<input type="radio" id="woman" name="gender" value="0" />
										<label for="woman">女</label>
									</td>
									<td></td>
								</tr>
								
								
							</table>
							
						</div>
						<a href="javascript:updateUser()" class="btn btn-secondary text-white" id="update_su">确认修改</a>
				</div>			
		</div>
		</div>
		<script>
		var uid='';
		function updateUser(){
			var xhr=new XMLHttpRequest();
			xhr.onreadystatechange=function(){
				if(xhr.readyState==4&&xhr.status==200){
					var result=xhr.responseText;
					console.log(result);
					if(result=="1"){
						alert("修改成功");
						//使用js的bom操作
						location.href="admin.html#content4";
					}else{
						alert('修改失败');
					}
				}
			}
			xhr.open('post','/user/updateUser',true);
			var gender="";
			if(man.checked){
				gender="1";
			}else if(woman.checked){
				gender='0';
			}
			var formdata="uname="+uname.value+"&upwd="+upwd.value+"&emaiil="+emaiil.value+"&phone="+phone.value+"&gender="+gender+"&username="+username.value+"&uid="+uid;
			xhr.setRequestHeader("Content-Type","application/x-www-form-urlencoded");
			console.log(formdata);
			xhr.send(formdata);
		}
			function getInfo(){
				//获取当前url中的参数uid
				var urlParams=new URLSearchParams(location.search);
				uid=urlParams.get('uid');
				console.log(uid);
				//
				var xhr=new XMLHttpRequest();
				xhr.onreadystatechange=function(){
					if(xhr.readyState==4&&xhr.status==200){
						var result=xhr.responseText;
						console.log(result);
						if(result=='1'){
							alert('没有查询到用户名信息');
							return;
						}else if(result=='0'){
							alert('uid不存在');
							return;
						}
						console.log(result);
						var user=JSON.parse(result);
						uname.value=user.uname;
						upwd.value=user.upwd;
						emaiil.value=user.emaiil;
						phone.value=user.phone;
						username.value=user.username;
						if(user.gender=='0'){
							woman.checked=true;
						}else if(user.gender=='1'){
							man.checked=true;
						}
					}
				}
				xhr.open('get','/user/query?uid='+uid,true);
				xhr.send();
			}
		</script>
	</body>
</html>
